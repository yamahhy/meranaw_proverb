<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meranaw Pananaroon - Preservation of Meranaw Proverbs</title>

    <!-- External Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
    />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#6f1926",
              accent: "#e5c121",
            },
            borderRadius: {
              button: "8px",
            },
          },
        },
      };
    </script>
    <!-- Custom CSS -->
    <style>
      /* Theme boxes styling */
      .theme-box {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        min-height: 90px;
      }

      .theme-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
      }

      /* Custom checkbox styling */
      .custom-checkbox {
        position: relative;
        padding-left: 35px;
        cursor: pointer;
      }

      .custom-checkbox input {
        position: absolute;
        opacity: 0;
      }

      .checkmark {
        position: absolute;
        top: 0;
        left: 0;
        height: 20px;
        width: 20px;
        background-color: #fff;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
      }
      .modal-box {
        transform: scale(0.95);
        animation: zoomIn 0.3s forwards;
        position: fixed;
        inset: 0; /* top: 0, right: 0, bottom: 0, left: 0 */
        background-color: rgba(0, 0, 0, 0.5); /* semi-transparent black */
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 30;
        display: none; /* hidden by default */
      }
      .modal.show {
        display: flex;
      }

      .modal-content {
        background-color: white;
        border-radius: 0.5rem; /* rounded corners */
        max-width: 42rem; /* same as max-w-2xl */
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        padding: 1.5rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      }
      @keyframes zoomIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .custom-checkbox:hover input ~ .checkmark {
        background-color: #f9fafb;
      }

      .custom-checkbox input:checked ~ .checkmark {
        background-color: #6f1926;
        border-color: #6f1926;
      }

      .checkmark:after {
        content: "";
        position: absolute;
        display: none;
      }

      .custom-checkbox input:checked ~ .checkmark:after {
        display: block;
      }

      .custom-checkbox .checkmark:after {
        left: 7px;
        top: 3px;
        width: 6px;
        height: 12px;
        border: solid white;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
      }
      .theme-box {
        transition: all 0.3s ease;
        border-width: 1px;
      }
      .theme-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
      }
      .leadership-box {
        border-color: rgba(111, 25, 38, 0.5);
        color: rgb(111, 25, 38);
      }
      .leadership-box:hover {
        background-color: rgba(111, 25, 38, 0.05);
      }

      .conflict-resolution-box {
        border-color: rgba(229, 193, 33, 0.5);
        color: #9b7f00;
      }
      .conflict-resolution-box:hover {
        background-color: rgba(229, 193, 33, 0.05);
      }

      .argumentation-box {
        border-color: rgba(148, 32, 49, 0.5);
        color: rgb(148, 32, 49);
      }
      .argumentation-box:hover {
        background-color: rgba(148, 32, 49, 0.05);
      }

      .death-sermon-box {
        border-color: rgba(229, 193, 33, 0.5);
      }
      .death-sermon-box:hover {
        background-color: rgba(229, 193, 33, 0.05);
      }

      .enthronement-genealogy-box {
        border-color: rgba(111, 25, 38, 0.5);
        color: rgb(111, 25, 38);
      }
      .enthronement-genealogy-box:hover {
        background-color: rgba(111, 25, 38, 0.05);
      }

      .courtship-marriage-box {
        border-color: rgba(229, 193, 33, 0.5);
        color: #9b7f00;
      }
      .courtship-marriage-box:hover {
        background-color: rgba(229, 193, 33, 0.05);
      }

      .moral-teaching-box {
        border-color: rgba(148, 32, 49, 0.5);
        color: rgb(148, 32, 49);
      }
      .moral-teaching-box:hover {
        background-color: rgba(148, 32, 49, 0.05);
      }

      /* Animations */
      .sidebar {
        transition: transform 0.3s ease;
        transform: translateX(100%); /* Default closed state */
      }

      .sidebar.open {
        transform: translateX(0); /* Open state */
      }

      .notification {
        animation: slideIn 0.3s forwards;
      }

      .modal {
        animation: fadeIn 0.2s;
      }

      @keyframes slideIn {
        from {
          transform: translateY(100%);
        }
        to {
          transform: translateY(0);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
    </style>
    <link rel="stylesheet" href="./static/styles.css" />
    <script src="https://www.gstatic.com/firebasejs/11.7.3/firebase-app-compat.js"></script>

    <!-- Firebase Firestore (compat version) -->
    <script src="https://www.gstatic.com/firebasejs/11.7.3/firebase-firestore-compat.js"></script>
  </head>

  <body class="bg-white min-h-screen font-sans">
    <!-- Main Container -->
    <div class="relative min-h-screen">
      <!-- Header -->
      <header
        class="w-full py-6 px-8 flex items-center border-b border-gray-100"
      >
        <div class="w-1/4"><!-- Left spacer --></div>
        <div class="flex-1 flex justify-center">
          <h1
            class="text-4xl font-bold bg-gradient-to-r from-[#6f1926] via-[#942031] to-[#e5c121] bg-clip-text text-transparent"
          >
            PANANAROON
          </h1>
        </div>
        <div class="w-1/4 flex justify-end items-center gap-4">
          <div class="relative">
            <button
              id="filterBtn"
              class="flex items-center gap-2 text-gray-700 px-4 py-2 rounded-button border border-gray-200 hover:bg-gray-50 whitespace-nowrap"
            >
              <span class="w-5 h-5 flex items-center justify-center">
                <i class="ri-filter-3-line"></i>
              </span>
              <span>Filter</span>
            </button>
            <div
              id="filterDropdown"
              class="hidden absolute right-0 mt-2 w-48 bg-white rounded shadow-lg z-10 border border-gray-100"
            >
              <div class="p-3">
                <h3 class="font-medium text-gray-700 mb-2">Filter by Theme</h3>
                <div class="space-y-2">
                  <label
                    class="custom-checkbox flex items-center gap-3 text-sm text-gray-600"
                  >
                    <input type="checkbox" value="courtship_marriage" checked />
                    <span class="checkmark"></span>
                    <span class="ml-6">Courtship/Marriage</span>
                  </label>
                  <label
                    class="custom-checkbox flex items-center gap-3 text-sm text-gray-600"
                  >
                    <input type="checkbox" value="leadership" checked />
                    <span class="checkmark"></span>
                    <span class="ml-6">Leadership</span>
                  </label>
                  <label
                    class="custom-checkbox flex items-center gap-3 text-sm text-gray-600"
                  >
                    <input
                      type="checkbox"
                      value="conflict_resolution"
                      checked
                    />
                    <span class="checkmark"></span>
                    <span class="ml-6">Conflict Resolution</span>
                  </label>
                  <label
                    class="custom-checkbox flex items-center gap-3 text-sm text-gray-600"
                  >
                    <input type="checkbox" value="argumentation" checked />
                    <span class="checkmark"></span>
                    <span class="ml-6">Argumentation</span>
                  </label>
                  <label
                    class="custom-checkbox flex items-center gap-3 text-sm text-gray-600"
                  >
                    <input type="checkbox" value="death_sermon" checked />
                    <span class="checkmark"></span>
                    <span class="ml-6">Death Sermon</span>
                  </label>
                  <label
                    class="custom-checkbox flex items-center gap-3 text-sm text-gray-600"
                  >
                    <input
                      type="checkbox"
                      value="enthronement_genealogy"
                      checked
                    />
                    <span class="checkmark"></span>
                    <span class="ml-6">Enthronement/Genealogy</span>
                  </label>
                  <label
                    class="custom-checkbox flex items-center gap-3 text-sm text-gray-600"
                  >
                    <input type="checkbox" value="moral_teaching" checked />
                    <span class="checkmark"></span>
                    <span class="ml-6">Moral Teaching</span>
                  </label>
                </div>
                <button
                  id="applyFiltersBtn"
                  class="mt-3 w-full bg-primary text-white py-1.5 px-3 rounded-button text-sm font-medium hover:bg-opacity-90 whitespace-nowrap"
                >
                  Apply Filters
                </button>
              </div>
            </div>
          </div>
          <button
            id="menuToggle"
            class="w-10 h-10 flex items-center justify-center text-gray-700 hover:bg-gray-100 rounded-full"
          >
            <i class="ri-menu-line text-xl"></i>
          </button>
        </div>
      </header>
      <!-- Main Content -->
      <main class="container mx-auto px-6 py-8">
        <!-- Search Bar -->
        <div class="max-w-xl mx-auto mb-16">
          <div class="relative">
            <input
              id="searchInput"
              type="text"
              placeholder="Search Meranaw proverbs..."
              class="w-full h-12 px-5 py-3 pl-12 text-base rounded-xl bg-white text-gray-700 border border-transparent relative"
              style="
                background: linear-gradient(white, white) padding-box,
                  linear-gradient(90deg, #6f1926 0%, #942031 50%, #e5c121 100%)
                    border-box;
                border-width: 1px;
              "
            />
            <div
              class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5 flex items-center justify-center"
            >
              <i class="ri-search-line text-lg"></i>
            </div>
            <button
              id="searchButton"
              class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-primary text-white px-4 py-1.5 rounded-button text-sm font-medium hover:bg-opacity-90 whitespace-nowrap transition-all duration-200"
            >
              Search
            </button>
          </div>
        </div>

        <!-- Search Results View -->
        <div id="searchResultsView" class="hidden max-w-4xl mx-auto">
          <div class="mb-6">
            <button
              id="backFromSearch"
              class="flex items-center gap-2 text-gray-600 hover:text-primary"
            >
              <span class="w-5 h-5 flex items-center justify-center">
                <i class="ri-arrow-left-line"></i>
              </span>
              <span>Back to Categories</span>
            </button>
          </div>
          <h1 class="text-2xl font-bold text-center mb-8 text-accent">
            Search Results
          </h1>
          <div id="searchResults" class="space-y-4"></div>
          <div id="noResults" class="hidden text-center py-8">
            <div class="w-16 h-16 mx-auto mb-4 text-gray-300">
              <i class="ri-search-line text-5xl"></i>
            </div>
            <h3 class="text-lg font-medium text-gray-700 mb-2">
              No results found
            </h3>
            <p class="text-gray-500 mb-4">
              Try different keywords or check your spelling
            </p>
            <button id="clearSearch" class="text-primary hover:text-opacity-80">
              Clear search and start over
            </button>
          </div>
        </div>
        <!-- Theme Categories -->
        <div
          id="dashboardView"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto"
        >
          <div
            class="theme-box leadership-box rounded p-6 flex items-center justify-center cursor-pointer"
            data-theme="leadership"
          >
            <h2 class="text-xl font-semibold">Leadership</h2>
          </div>
          <div
            class="theme-box conflict-resolution-box rounded p-6 flex items-center justify-center cursor-pointer"
            data-theme="conflict_resolution"
          >
            <h2 class="text-xl font-semibold">Conflict Resolution</h2>
          </div>
          <div
            class="theme-box argumentation-box rounded p-6 flex items-center justify-center cursor-pointer"
            data-theme="argumentation"
          >
            <h2 class="text-xl font-semibold">Argumentation</h2>
          </div>
          <div
            class="theme-box death-sermon-box rounded p-6 flex items-center justify-center cursor-pointer"
            data-theme="death_sermon"
          >
            <h2 class="text-xl font-semibold">Death Sermon</h2>
          </div>
          <div
            class="theme-box enthronement-genealogy-box rounded p-6 flex items-center justify-center cursor-pointer"
            data-theme="enthronement_genealogy"
          >
            <h2 class="text-xl font-semibold">Enthronement & Genealogy</h2>
          </div>
          <div
            class="theme-box courtship-marriage-box rounded p-6 flex items-center justify-center cursor-pointer"
            data-theme="courtship_marriage"
          >
            <h2 class="text-xl font-semibold">Courtship & Marriage</h2>
          </div>
          <div
            class="theme-box moral-teaching-box rounded p-6 flex items-center justify-center cursor-pointer"
            data-theme="moral_teaching"
          >
            <h2 class="text-xl font-semibold">
              Moral Teaching & Self-Reflection
            </h2>
          </div>
        </div>
        <!-- Proverb List View (Initially Hidden) -->
        <div id="proverbListView" class="hidden max-w-4xl mx-auto">
          <div class="mb-6">
            <button
              id="backToDashboard"
              class="flex items-center gap-2 text-gray-600 hover:text-primary"
            >
              <span class="w-5 h-5 flex items-center justify-center">
                <i class="ri-arrow-left-line"></i>
              </span>
              <span>Back to Categories</span>
            </button>
          </div>
          <h1
            id="themeTitle"
            class="text-2xl font-bold text-center mb-8 text-accent"
          >
            Community & Society
          </h1>
          <div class="space-y-4">
            <!-- Proverbs will be loaded dynamically here -->
          </div>
        </div>
      </main>
      <!-- Sidebar -->
      <div
        id="sidebar"
        class="fixed top-0 right-0 w-80 h-full bg-white shadow-lg transform translate-x-full sidebar z-20"
      >
        <div class="p-6">
          <div class="flex justify-between items-center mb-8">
            <h2 class="text-xl font-bold text-primary">Menu</h2>
            <button
              id="closeSidebar"
              class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full"
            >
              <i class="ri-close-line text-xl"></i>
            </button>
          </div>
          <button
            id="contributeBtn"
            class="w-full bg-primary text-white py-3 px-4 rounded-button mb-6 flex items-center justify-center gap-2 hover:bg-opacity-90 whitespace-nowrap"
          >
            <span class="w-5 h-5 flex items-center justify-center">
              <i class="ri-add-line"></i>
            </span>
            <span>Contribute a Proverb</span>
          </button>
          <nav class="space-y-6">
            <div>
              <h3
                class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3"
              >
                Navigation
              </h3>
              <ul class="space-y-2">
                <li>
                  <a
                    href="#"
                    class="flex items-center gap-3 text-gray-700 hover:text-primary py-2"
                  >
                    <span class="w-5 h-5 flex items-center justify-center">
                      <i class="ri-home-line"></i>
                    </span>
                    <span>Home</span>
                  </a>
                </li>
                <li>
                  <a
                    href="#"
                    class="flex items-center gap-3 text-gray-700 hover:text-primary py-2"
                  >
                    <span class="w-5 h-5 flex items-center justify-center">
                      <i class="ri-book-open-line"></i>
                    </span>
                    <span>Ethical Principles</span>
                  </a>
                </li>
                <li>
                  <a
                    href="#"
                    class="flex items-center gap-3 text-gray-700 hover:text-primary py-2"
                  >
                    <span class="w-5 h-5 flex items-center justify-center">
                      <i class="ri-information-line"></i>
                    </span>
                    <span>About</span>
                  </a>
                </li>
                <li>
                  <a
                    href="#"
                    class="flex items-center gap-3 text-gray-700 hover:text-primary py-2"
                  >
                    <span class="w-5 h-5 flex items-center justify-center">
                      <i class="ri-file-list-line"></i>
                    </span>
                    <span>Sources</span>
                  </a>
                </li>
              </ul>
            </div>
            <div>
              <h3
                class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3"
              >
                Additional Resources
              </h3>
              <ul class="space-y-2">
                <li>
                  <a
                    href="#"
                    class="flex items-center gap-3 text-gray-700 hover:text-primary py-2"
                  >
                    <span class="w-5 h-5 flex items-center justify-center">
                      <i class="ri-book-line"></i>
                    </span>
                    <span>Meranaw Culture</span>
                  </a>
                </li>
                <li>
                  <a
                    href="#"
                    class="flex items-center gap-3 text-gray-700 hover:text-primary py-2"
                  >
                    <span class="w-5 h-5 flex items-center justify-center">
                      <i class="ri-translate-2"></i>
                    </span>
                    <span>Language Resources</span>
                  </a>
                </li>
                <li>
                  <a
                    href="#"
                    class="flex items-center gap-3 text-gray-700 hover:text-primary py-2"
                  >
                    <span class="w-5 h-5 flex items-center justify-center">
                      <i class="ri-contacts-line"></i>
                    </span>
                    <span>Contact Us</span>
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
      <!-- Proverb Detail Modal -->
      <div
        id="proverbModal"
        class="fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center px-4 py-8 overflow-auto hidden"
      >
        <div class="bg-white rounded-lg w-full max-w-2xl mx-auto shadow-lg p-6">
          <div class="p-6">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-xl font-bold text-primary">Proverb Details</h2>
              <button
                id="closeProverbModal"
                class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full"
              >
                <i class="ri-close-line text-xl"></i>
              </button>
            </div>
            <div class="mb-2 text-xs text-gray-500">
              ID: <span id="proverbId">CS001</span>
            </div>
            <div class="space-y-4 mb-6">
              <div>
                <h3 class="text-sm font-semibold text-gray-500">Proverb:</h3>
                <p id="proverbText" class="text-lg font-medium text-primary">
                  Aya ipkhababaya o taw na ipkhababaya niyan ko pagari niyan
                </p>
              </div>
              <div>
                <h3 class="text-sm font-semibold text-gray-500">
                  Literal Meaning:
                </h3>
                <p id="literalMeaning" class="text-gray-700">
                  What one wishes for himself, he should wish for his brother.
                </p>
              </div>
              <div>
                <h3 class="text-sm font-semibold text-gray-500">
                  English Translation:
                </h3>
                <p id="englishTranslation" class="text-gray-700">
                  What one wishes for himself, he should wish for his brother.
                </p>
              </div>
            </div>
            <div class="pt-4 border-t border-gray-100">
              <button
                id="interpretBtn"
                class="bg-accent text-white py-2 px-4 rounded-button hover:bg-opacity-90 whitespace-nowrap"
              >
                <span class="flex items-center gap-2">
                  <span class="w-5 h-5 flex items-center justify-center">
                    <i
                      onclick="generateInterpretation()"
                      class="ri-lightbulb-line"
                    ></i>
                  </span>
                  <span>Generate Interpretation</span>
                </span>
              </button>
              <div
                id="interpretationContainer"
                class="mt-4 p-4 bg-gray-50 rounded hidden"
              >
                <h3 class="text-sm font-semibold text-gray-500 mb-2">
                  Interpretation:
                </h3>
                <p id="interpretationText" class="text-gray-700">
                  This proverb emphasizes the importance of empathy and treating
                  others with the same consideration we desire for ourselves. It
                  reflects the golden rule found in many cultures and religions,
                  encouraging people to extend their good wishes and actions to
                  others, especially those close to them. In Meranaw society,
                  this proverb reinforces the value of community solidarity and
                  familial bonds.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Contribute Modal -->
      <div
        id="contributionModal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-30 hidden modal"
      >
        <div
          class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"
        >
          <div class="p-6">
            <div class="flex justify-between items-center mb-6">
              <h2 class="text-xl font-bold text-primary">
                Contribute a Proverb
              </h2>
              <button
                id="closeContribution"
                class="w-8 h-8 flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full"
              >
                <i class="ri-close-line text-xl"></i>
              </button>
            </div>
            <form id="contributeForm" class="space-y-4">
              <div>
                <label
                  for="proverb"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Meranaw Proverb:</label
                >
                <input
                  type="text"
                  id="proverb"
                  name="proverb"
                  class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                  placeholder="Enter the original Meranaw proverb"
                  required
                />
              </div>
              <div>
                <label
                  for="literal_meaning"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Literal Meaning:</label
                >
                <textarea
                  id="literal_meaning"
                  name="literal_meaning"
                  rows="3"
                  class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                  placeholder="Enter the literal meaning of the proverb"
                  required
                ></textarea>
              </div>
              <div>
                <label
                  for="english_translation"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >English Translation:</label
                >
                <textarea
                  id="english_translation"
                  name="english_translation"
                  rows="3"
                  class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                  placeholder="Enter the English translation of the proverb"
                  required
                ></textarea>
              </div>
              <div>
                <label
                  for="theme"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Theme:</label
                >
                <div class="relative">
                  <select
                    id="theme"
                    name="theme"
                    class="w-full px-4 py-2 border border-gray-300 rounded appearance-none focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent pr-8"
                    required
                  >
                    <option value="" disabled selected>Select a theme</option>
                    <option value="courtship_marriage">
                      Courtship/Marriage
                    </option>
                    <option value="leadership">Leadership</option>
                    <option value="conflict_resolution">
                      Conflict Resolution
                    </option>
                    <option value="argumentation">Argumentation</option>
                    <option value="death_sermon">Death Sermon</option>
                    <option value="enthronement_genealogy">
                      Enthronement/Genealogy
                    </option>
                    <option value="moral_teaching">
                      Moral Teaching and Self-Reflection
                    </option>
                  </select>
                  <div
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none w-5 h-5 flex items-center justify-center"
                  >
                    <i class="ri-arrow-down-s-line text-gray-400"></i>
                  </div>
                </div>
              </div>
              <div>
                <label
                  for="source"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Source:</label
                >
                <input
                  type="text"
                  id="source"
                  name="source"
                  class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
                  placeholder="Enter the source of the proverb (e.g., book, elder, personal knowledge)"
                  required
                />
              </div>
              <div class="pt-4">
                <button
                  type="submit"
                  class="w-full bg-primary text-white py-3 px-4 rounded-button hover:bg-opacity-90 whitespace-nowrap"
                >
                  Submit Contribution
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- Notification -->
      <div
        id="notification"
        class="hidden fixed bottom-0 left-0 m-6 p-4 bg-white rounded shadow-lg border-l-4 border-green-500 notification z-40"
      >
        <div class="flex items-start gap-3">
          <div class="w-6 h-6 flex items-center justify-center text-green-500">
            <i class="ri-check-line"></i>
          </div>
          <div>
            <h3 class="font-medium text-green-800"></h3>
            <p class="text-sm text-green-700">
              The cultural experts will review and validate your submission.
              Your effort helps preserve Meranaw cultural heritage.
            </p>
          </div>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const searchInput = document.getElementById("searchInput");
        const searchButton = document.getElementById("searchButton");
        const searchResultsView = document.getElementById("searchResultsView");
        const searchResults = document.getElementById("searchResults");
        const noResults = document.getElementById("noResults");
        const backFromSearch = document.getElementById("backFromSearch");
        const clearSearch = document.getElementById("clearSearch");
        const proverbModal = document.getElementById("proverbModal");
        const proverbId = document.getElementById("proverbId");
        const menuToggle = document.getElementById("menuToggle");
        const sidebar = document.getElementById("sidebar");
        const closeSidebar = document.getElementById("closeSidebar");
        const filterBtn = document.getElementById("filterBtn");
        const filterDropdown = document.getElementById("filterDropdown");
        const applyFiltersBtn = document.getElementById("applyFiltersBtn");
        const themeBoxes = document.querySelectorAll(".theme-box");
        const dashboardView = document.getElementById("dashboardView");
        const proverbListView = document.getElementById("proverbListView");
        const backToDashboard = document.getElementById("backToDashboard");
        const themeTitle = document.getElementById("themeTitle");
        const proverbListContainer =
          proverbListView.querySelector(".space-y-4");
        const contributeBtn = document.getElementById("contributeBtn");
        const contributionModal = document.getElementById("contributionModal");
        const closeContribution = document.getElementById("closeContribution");
        const contributionForm = document.getElementById("contributionForm");
        const closeContributeModal = document.getElementById(
          "closeContributeModal"
        );
        const submitContribution = document.getElementById("submit");
        const notificationArea = document.getElementById("notificationArea");
        const notificationMessage = document.getElementById(
          "notificationMessage"
        );
        const closeNotification = document.getElementById("closeNotification");

        const closeProverbModal = document.getElementById("closeProverbModal");
        if (closeProverbModal) {
          closeProverbModal.addEventListener("click", () => {
            proverbModal.classList.add("hidden");
            interpretationContainer.classList.add("hidden");
          });
        }

        let allProverbs = [];
        let filteredProverbs = [];
        let activeFilters = new Set([
          "courtship_marriage",
          "leadership",
          "conflict_resolution",
          "argumentation",
          "death_sermon",
          "enthronement_genealogy",
          "moral_teaching",
        ]);

        // const highlightText = (text, query) => {
        //   const regex = new RegExp(`(${query})`, "gi");
        //   return text.replace(
        //     regex,
        //     '<mark class="bg-accent/20 rounded px-0.5">$1</mark>'
        //   );
        // };
        // Function to show a notification
        function showNotification(message) {
          notificationMessage.textContent = message;
          notificationArea.classList.remove("translate-y-full");
          setTimeout(() => {
            notificationArea.classList.add("translate-y-full");
          }, 3000); // Hide after 3 seconds
        }

        // Event listeners for sidebar
        menuToggle.addEventListener("click", function () {
          sidebar.classList.toggle("translate-x-full");
          sidebar.classList.toggle("translate-x-0");
        });

        if (closeSidebar) {
          closeSidebar.addEventListener("click", function () {
            sidebar.classList.add("translate-x-full");
            sidebar.classList.remove("translate-x-0");
          });
        }

        // closeSidebar.addEventListener("click", function () {
        //   sidebar.classList.add("translate-x-full");
        //   sidebar.classList.remove("translate-x-0");
        // });

        // Event listeners for filter dropdown
        filterBtn.addEventListener("click", () => {
          filterDropdown.classList.toggle("hidden");
        });

        applyFiltersBtn.addEventListener("click", () => {
          const checkedFilters = Array.from(
            filterDropdown.querySelectorAll('input[type="checkbox"]:checked')
          ).map((checkbox) => checkbox.value);
          activeFilters = new Set(checkedFilters);
          filterDropdown.classList.add("hidden");
          filterProverbs();
          if (proverbListView.classList.contains("hidden")) {
            displayDashboard();
          } else {
            displayProverbs(filteredProverbs, themeTitle.textContent);
          }
        });

        // Event listeners for theme navigation
        dashboardView.querySelectorAll(".theme-box").forEach((box) => {
          box.addEventListener("click", function () {
            const theme = this.dataset.theme;
            const themeText = this.querySelector("h2").textContent;
            filterProverbs(theme);
            themeTitle.textContent = themeText;
            dashboardView.classList.add("hidden");
            proverbListView.classList.remove("hidden");
          });
        });

        backToDashboard.addEventListener("click", () => {
          dashboardView.classList.remove("hidden");
          proverbListView.classList.add("hidden");
        });

        function displaySearch(results, searchTerm) {
          searchResultsDiv.innerHTML = "";
          showProverbList(`Search Results for "${searchTerm}"`);

          if (results.length === 0) {
            searchResultsDiv.innerHTML = "<p>No proverbs found.</p>";
            return;
          }

          const gridContainer = document.createElement("div");
          gridContainer.classList.add(
            "grid",
            "grid-cols-1",
            "md:grid-cols-2",
            "lg:grid-cols-3",
            "gap-4"
          );

          results.forEach((proverb) => {
            const proverbBox = document.createElement("div");
            proverbBox.classList.add(
              "bg-white",
              "rounded-lg",
              "shadow-md",
              "p-6",
              "cursor-pointer",
              "hover:shadow-lg",
              "transition-shadow"
            );
            proverbBox.innerHTML = `
                                <h3 class="text-lg font-semibold text-primary mb-2">${
                                  proverb.meranaw
                                }</h3>
                                <p class="text-gray-700 mb-1"><span class="font-semibold">Translation:</span> ${
                                  proverb.english
                                }</p>
                                <p class="text-sm text-gray-500"><span class="font-semibold">Theme:</span> ${proverb.theme.replace(
                                  /_/g,
                                  " "
                                )}</p>
                            `;
            proverbBox.addEventListener("click", () => {
              const themeId = proverb.theme.toLowerCase().replace(/ /g, "-");
              const targetThemeBox = document.querySelector(`.${themeId}-box`);

              if (targetThemeBox) {
                targetThemeBox.scrollIntoView({
                  behavior: "smooth",
                  block: "start",
                });
              } else {
                console.log(`Theme box for "${proverb.theme}" not found.`);
              }
            });
            gridContainer.appendChild(proverbBox);
          });

          searchResultsDiv.appendChild(gridContainer);
        }
        themeBoxes.forEach((box) => {
          box.addEventListener("click", function () {
            const theme = this.querySelector("h2")
              .textContent.toLowerCase()
              .replace(/ /g, "_");
            const filtered = allProverbs.filter(
              (p) => p.theme.toLowerCase() === theme
            );
            displayProverbs(filtered, this.querySelector("h2").textContent);
          });
        });

        // Function to filter proverbs based on active filters and optionally a theme
        function filterProverbs(theme = null) {
          filteredProverbs = allProverbs.filter((proverb) => {
            const matchesTheme = !theme || proverb.theme === theme;
            return matchesTheme && activeFilters.has(proverb.theme);
          });
        }

        // Function to display proverbs in the list view
        function displayProverbs(proverbs, title) {
          themeTitle.textContent = title;
          proverbListContainer.innerHTML = "";
          if (proverbs.length === 0) {
            proverbListContainer.innerHTML =
              '<p class="text-gray-500 text-center">No proverbs found.</p>';
          } else {
            proverbs.forEach((proverb) => {
              const proverbDiv = document.createElement("div");
              proverbDiv.classList.add(
                "bg-white",
                "rounded-lg",
                "shadow-md",
                "p-6"
              );
              proverbDiv.innerHTML = `
                                        <h3 class="text-lg font-semibold text-primary mb-2">${
                                          proverb.meranaw
                                        }</h3>
                                        <p class="text-gray-700 mb-1"><strong>Translation:</strong> ${
                                          proverb.english
                                        }</p>
                                        <p class="text-sm text-gray-500"><strong>Theme:</strong> ${proverb.theme.replace(
                                          /_/g,
                                          " "
                                        )}</p>
                                    `;
              proverbListContainer.appendChild(proverbDiv);
            });
          }
        }
        function displayProverbs(proverbs, currentThemeTitle) {
          const proverbListContainer = document.querySelector(
            "#proverbListView .space-y-4"
          );
          const themeTitle = document.getElementById("themeTitle");

          themeTitle.textContent = currentThemeTitle;
          proverbListContainer.innerHTML = "";

          if (proverbs.length === 0) {
            proverbListContainer.innerHTML =
              '<p class="text-gray-500 text-center">No proverbs found.</p>';
            return;
          }
          function showProverbDetails(proverbId) {
            console.log("Clicked proverb ID:", proverbId); // Add this for debugging
            const proverb = allProverbs.find((p) => p.id === proverbId);
            if (!proverb) {
              console.warn("Proverb not found for ID:", proverbId);
              return;
            }

            document.getElementById("proverbId").textContent = proverb.id;
            document.getElementById("proverbText").textContent =
              proverb.meranaw;
            document.getElementById("literalMeaning").textContent =
              proverb.literal_meaning;
            document.getElementById("englishTranslation").textContent =
              proverb.english_translation;

            document
              .getElementById("interpretationContainer")
              .classList.add("hidden");
            document.getElementById("interpretationText").textContent = "";

            if (modal) {
              modal.classList.remove("hidden");
              modal.style.display = "block"; // Ensure it's visible
            }
          }

          proverbs.forEach((proverb) => {
            const div = document.createElement("div");
            div.className = "bg-white rounded-lg shadow-md p-6 cursor-pointer";
            div.innerHTML = `
                      <h3 class="text-lg font-semibold text-primary mb-2">${proverb.meranaw}</h3>
                      <p class="text-gray-700 italic">${proverb.literal_meaning}</p>
                    `;
            div.addEventListener("click", () => {
              showProverbDetails(proverb.id);
            });
            proverbListContainer.appendChild(div);
          });
        }

        // Function to display the dashboard view
        function displayDashboard() {
          dashboardView.classList.remove("hidden");
          proverbListView.classList.add("hidden");
          themeTitle.textContent = "Meranaw Proverbs"; // Reset title
        }
        // Contribution modal functionality
        contributeBtn.addEventListener("click", function () {
          contributionModal.classList.remove("hidden");
          sidebar.classList.add("translate-x-full");
          sidebar.classList.remove("translate-x-0");
        });

        if (closeContribution) {
          closeContribution.addEventListener("click", () => {
            contributionModal.classList.add("hidden");
            contributionForm.reset();
          });
        }

        if (contributionForm) {
          contributionForm.addEventListener("submit", function (event) {
            event.preventDefault();

            const proverbText = document
              .getElementById("proverbText")
              .value.trim();
            const proverbTranslation = document
              .getElementById("proverbTranslation")
              .value.trim();
            const proverbTheme = document.getElementById("proverbTheme").value;

            if (proverbText && proverbTranslation && proverbTheme) {
              window.firebaseService
                .addProverb({
                  meranaw: proverbText,
                  english: proverbTranslation,
                  theme: proverbTheme,
                })
                .then(() => {
                  showNotification("Proverb submitted for review!");
                  contributionModal.classList.add("hidden");
                  contributionForm.reset();
                  // Optionally refresh the proverb list after submission
                  loadInitialProverbs();
                })
                .catch((error) => {
                  console.error("Error adding proverb:", error);
                  showNotification("Thank you for your contribution");
                });
            } else {
              showNotification("Please fill in all the fields.");
            }

            const notification = document.getElementById("notification");
            notification.classList.remove("hidden");

            // Auto-hide after 5 seconds
            setTimeout(() => {
              notification.classList.add("hidden");
            }, 5000);
          });
        }

        if (closeNotification && notificationArea) {
          closeNotification.addEventListener("click", () => {
            notificationArea.classList.add("translate-y-full");
          });
        }

        const highlightText = (text, query) => {
          const regex = new RegExp(`(${query})`, "gi");
          return text.replace(
            regex,
            '<mark class="bg-accent/20 rounded px-0.5">$1</mark>'
          );
        };

        const performSearch = async () => {
          const query = searchInput.value.trim();
          if (!query) return;

          dashboardView.classList.add("hidden");
          searchResultsView.classList.remove("hidden");

          try {
            const response = await fetch("http://localhost:3000/search", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ query }),
            });

            if (!response.ok) throw new Error("Search request failed.");

            const data = await response.json();

            if (data.length > 0) {
              searchResults.innerHTML = data
                .map(
                  (proverb) => `
                    <div class="proverb-item p-4 border border-gray-200 rounded cursor-pointer" data-id="${
                      proverb.meranaw_proverb
                    }">
                      <div class="flex justify-between">
                        <h3 class="text-lg font-medium text-primary">${highlightText(
                          proverb.meranaw_proverb,
                          query
                        )}</h3>
                        <span class="text-xs text-gray-500">${
                          proverb.search_type
                        }</span>
                      </div>
                      <p class="text-gray-600 italic">${highlightText(
                        proverb.augmented_interpretation,
                        query
                      )}</p>
                    </div>
                  `
                )
                .join("");

              // Attach modal logic
              searchResults
                .querySelectorAll(".proverb-item")
                .forEach((item) => {
                  item.addEventListener("click", function () {
                    const id = this.getAttribute("data-id");
                    proverbId.textContent = id;
                    proverbModal.classList.remove("hidden");
                  });
                });
              searchResults.classList.remove("hidden");
              noResults.classList.add("hidden");
            } else {
              searchResults.classList.add("hidden");
              noResults.classList.remove("hidden");
            }
          } catch (error) {
            console.error("Error fetching search results:", error);
            searchResults.innerHTML =
              '<p class="text-red-500">Something went wrong. Please try again.</p>';
          }
        };

        searchButton.addEventListener("click", performSearch);
        searchInput.addEventListener("keypress", function (e) {
          if (e.key === "Enter") performSearch();
        });

        backFromSearch.addEventListener("click", function () {
          searchResultsView.classList.add("hidden");
          dashboardView.classList.remove("hidden");
          searchInput.value = "";
        });

        clearSearch.addEventListener("click", function () {
          searchInput.value = "";
          searchResultsView.classList.add("hidden");
          dashboardView.classList.remove("hidden");
        });
      });
      // Initial data loading
      // function loadInitialProverbs() {
      //   if (
      //     window.firebaseService &&
      //     typeof window.firebaseService.getProverbs === "function"
      //   ) {
      //     window.firebaseService
      //       .getProverbs()
      //       .then((proverbs) => {
      //         allProverbs = proverbs;
      //         filterProverbs();
      //         displayDashboard(); // Show dashboard with initial filtered proverbs
      //       })
      //       .catch((error) => {
      //         console.error("Error fetching proverbs:", error);
      //         showNotification("Failed to load proverbs.");
      //       });
      //   } else {
      //     console.log("Firebase service not fully loaded yet, retrying...");
      //     setTimeout(loadInitialProverbs, 500); // Retry after a delay
      //   }
      // }

      //   // Initial load
    </script>
    <!-- Keep the main script import -->
    <script src="firebaseInit.js"></script>
    <script src="firebaseService.js"></script>
    <script src="./static/script.js" defer></script>
  </body>
</html>
